name: Invia Ordine Telegram

on:
  repository_dispatch:
    types: [new_order]

jobs:
  send_order:
    runs-on: ubuntu-latest
    steps:
      - name: Invia ordine a Telegram
        run: |
          MESSAGE="ğŸ• *Nuovo ordine ricevuto!*%0A%0AğŸ‘¤ Nome: ${{ github.event.client_payload.nome }}%0AğŸ  Indirizzo: ${{ github.event.client_payload.indirizzo }}%0AğŸ§¾ Ordine: ${{ github.event.client_payload.ordine }}%0AğŸ•’ Orario: ${{ github.event.client_payload.orario }}%0AğŸ“… Ricevuto: ${{ github.event.client_payload.timestamp }}"

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
          -d "text=$MESSAGE" \
          -d "parse_mode=Markdown"
