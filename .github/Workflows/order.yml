name: Invia Ordine Telegram

on:
  repository_dispatch:
    types: [new_order]

jobs:
  send_order:
    runs-on: ubuntu-latest
    steps:
      - name: Invia ordine a Telegram
        run: |
          MESSAGE="🍕 *Nuovo ordine ricevuto!*%0A%0A👤 Nome: ${{ github.event.client_payload.nome }}%0A🏠 Indirizzo: ${{ github.event.client_payload.indirizzo }}%0A🧾 Ordine: ${{ github.event.client_payload.ordine }}%0A🕒 Orario: ${{ github.event.client_payload.orario }}%0A📅 Ricevuto: ${{ github.event.client_payload.timestamp }}"

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
          -d "text=$MESSAGE" \
          -d "parse_mode=Markdown"
